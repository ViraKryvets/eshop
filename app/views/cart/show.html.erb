<div class="relative overflow-x-auto shadow-md sm:rounded-lg" >
  <% if notice.present? %>
    <p class="inline-block px-3 py-2 mb-5 font-medium text-green-500 rounded-lg bg-green-50" id="notice"><%= notice %></p>
  <% end %>

  <table id = "cart" class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
    <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
      <tr>
        <th scope="col" class="px-6 py-3">#</th>
        <th scope="col" class="px-6 py-3">Product</th>
        <th scope="col" class="px-6 py-3">Price</th>
        <th scope="col" class="px-6 py-3">Quantity</th>
        <th scope="col" class="px-6 py-3">Subtotal</th>
      </tr>
    </thead>
    <tbody>
      <% subtotal = 0 %>
      <% n = 1 %>
      <% @cart_items.each do |cart_item| %>
        <tr>
          <th class="px-6 py-4 font-medium whitespace-nowrap"><%= n %></th>
          <td class="px-6 py-4 font-semibold text-gray-900 dark:text-white">
            <%= cart_item[:product].name %>
          </td>
          <td class="px-6 py-4 font-semibold text-gray-900 dark:text-white">
            <%= cart_item[:price] %>
          </td>
          <td class="px-6 py-4">
            <%= form_tag update_cart_item_path(product_id: cart_item[:product].id), method: :put, class: 'flex items-center' do %>
              <%= number_field_tag 'quantity', cart_item[:quantity], min: 1, class: 'w-16 mr-2 py-1 px-2 border rounded' %>
              <%= submit_tag 'Update', class: 'bg-gray-500 text-white py-1 px-3 rounded hover:bg-gray-600' %>
              <%= link_to 'Remove', remove_from_cart_path(product_id: cart_item[:product].id), method: :delete, class: 'text-red-500 hover:text-red-600 ml-2' %>
            <% end %>
          </td >
          <% item_subtotal = cart_item[:quantity] * cart_item[:price] %>
          <td class="px-6 py-4 font-semibold text-gray-900 dark:text-white">
            <%= item_subtotal %>
          </td>
        </tr>
        <% subtotal += item_subtotal %>
        <% (n += 1) %>
      <% end %>
    </tbody>
    <tfoot>
      <tr class="border-b bg-neutral-100 dark:border-neutral-500 dark:bg-neutral-700">
        <th colspan="4" class="px-6 py-4 text-center whitespace-nowrap">Total:</th>
        <td class="px-6 py-4 font-semibold text-gray-900 dark:text-white"><%= @total_amount %></td>
      </tr>
    </tfoot>
  </table>
<!-- Make order button -->
  <%= button_to 'Make Order', new_order_path, method: :get, remote: true, class: "rounded-lg py-3 px-5 bg-gray-100 inline-block font-medium", style: "float: right"%>
</div>
